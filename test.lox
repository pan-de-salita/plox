// var a = "global a";
// var b = "global b";
// var c = "global c";
// {
//   var a = "outer a";
//   var b = "outer b";
//   {
//     var a = "inner a";
//     print a; // -> inner a
//     print b; // -> outer b
//     print c; // -> global c
//   }
//   print a; // -> outer a
//   print b; // -> outer b
//   print c; // -> global c
//   print c; // -> global c
// }
// print a; // -> global a
// print b; // -> global b
// print c; // -> global c

// print "beginning while loop.";
// var i = 10;
// while (i != 0) {
//   print "i is now " + i;
//   i = i - 1;
//
//   if (i == 5) print "pause muna.";
// }
// print "ending while loop.";

// var message = "Current number is ";
// for (var i = 10; i != 0; i = i - 1) {
//     print message + i;
//
//     for (i; i == 5; i = i - 1) print "MISSING NUMBER HERE.";
// }

// var a = 0;
// var temp;
//
// for (var b = 1; a < 10000; b = temp + b) {
//   print a;
//   temp = a;
//   a = b;
// }

// print "Here's a program that stops when the outer loop registers 2...";
// var msg = "OUTER LOOP.............................. ";
// var addon = "";
// for (var i = 10; i != 0; i = i - 1) {
//     if (i == 4) {
//         addon = " (OH BOY)";
//     }
//
//     if (i == 2) {
//         print "OUTER LOOP NUMBER IS NOW 2!";
//         print "STOPPING...";
//         break;
//     }
//
//     print msg + i + addon;
//
//     for (var j = i; j != 0; j = j - 1) {
//         if (j == 2) {
//           break;
//         }
//
//         print "INNER LOOP.................. " + j;
//     }
//
//     break;
// }

// fun sayHi(name) {
//   if (name == "miguel") {
//     print "hi miggy boy";
//   } else {
//     print "hi..." + name;
//   }
// }
//
// sayHi("john");
// sayHi("miguel");

// fun countOnlyEven(n) {
//     if (n > 1) countOnlyEven(n - 1);
//     if (n % 2 == 0) print n;
// }
//
// countOnlyEven(10);
//
// fun test() {
//     return 2;
// }
//
// print test() + 2;

// fun fib(n) {
//   if (n <= 1) return n;
//   return fib(n - 2) + fib(n - 1);
// }
//
// for (var i = 0; i < 20; i = i + 1) {
//   print fib(i);
// }

// A variable usage refers to the preceding declaration with the same name in
// the innermost scope that encloses the expression where the variable is used.
// fun makeCounter() {
//   var i = 0;
//
//   fun count() {
//     i = i + 1;
//     print i;
//   }
//
//   return count;
// }
//
// var counter = makeCounter();
// counter();
// counter();

// fun thrice(fn) {
//   for (var i = 1; i <= 3; i = i + 1) {
//     fn(i);
//   }
// }
//
// var printNum = fun (a) {
//   print a * 2;
// };
//
// thrice(printNum);

// var a = "global";
// {
//   fun showA() {
//     print a;
//   }
//
//   showA();
//   showA();
//   var a = "block";
//   print a;
// }

// class Test {
//   test_method() {
//     print "test method";
//   }
//
//   say_score() {
//     if (this.score) {
//       if (true) {
//         print "test score is " + this.score;
//       }
//     } else {
//       print "no test score yet.";
//     }
//   }
// }
//
// class Test_2 {
//   test_method() {
//     print "test method";
//   }
//
//   say_score() {
//     if (this.score) {
//       print "test score is " + this.score;
//     } else {
//       print "no test score yet.";
//     }
//   }
// }
//
// var test = Test();
// var test_2 = Test_2();
// test.score = 100;
// test_2.score = 80;
// test.say_score();
// test_2.say_score();

// var a = "global";
// {
//   fun showA() {
//     print a;
//   }
//
//   showA();
//   var a = "block";
//   showA();
//   print a;
// }

// class Cake {
//   taste() {
//     var adjective = "delicious";
//     print "The " + this.flavor + " cake is " + adjective + "!";
//   }
// }
//
// var cake = Cake();
// cake.flavor = "German chocolate";
// cake.taste();

// fun test() {
//   print "test";
// }
//
// class Thing {
//   getCallback() {
//     fun localFunction() {
//       print this;
//     }
//
//     print this.getCallback;
//     return localFunction;
//   }
// }
//
// var callback = Thing().getCallback();
// callback();
//
// print this;
//
// fun notAMethod() {
//   print this;
// }
//
// class Egotist {
//    speak() {
//      print this;
//    }
// }

// var method = Egotist().speak; // Access the method. Remembers the instance of the class it was accessed from.
// method();                     // Call the method.

class Cake {
  taste(description) {
    var test = "thing";
    print test;
    print "This " + this.flavor + " cake is " + description + "!";
  }

  taste_test(description) {
    print "This " + this.flavor + " cake is " + description + "!";
  }
}

var cake = Cake();
cake.flavor = "chocolate";
var method = cake.taste;
method("delicious");
// cake.taste_test("yummy");

// when we first evaluate the class definition, we create a LoxFunction for taste(). its closure is
// the environment surrounding the class, in this case the global one.
//
// when we evaluate the cake.taste get expression, we create a new environment that binds
// this to the object the method is accessed from (here, cake). then we make a new
// LoxFunction with the same code as the original but using that new environment as its closure.
//
// this is the LoxFunction that gets returned when evaluating the get expression for the method
// name. when that function is later called by a () expression, we create an environment for the
// method body as usual.
//
// the parent of the body environment is the environment we created earlier to bind this to the
// current object. thus any use of this inside the body successfully resolves to that instance.

// class Thing {
//   getCallback() {
//     fun localFunction() {
//       print this;
//     }
//
//     return localFunction;
//   }
// }

// var callback = Thing().getCallback();
// get expr binds instance to this expr. when immediately called with (),
// getCallback's body is evaluated, defining localFunction.
// localFunction's closure captures getCallback's environment, which has
// 'this' bound to the instance.callback();

// callback();
// localFunction is then able to access this (the instance) via its parent closure.
